## 简单动态字符串

`Redis`没有直接使用C语言传统得字符串表示(以空字符串结尾得字符数组),而是自己构建了一种名为简单动态字符串(`simple dynamic string, SDS`)的抽象类型,并将`SDS`用作`Redis`的默认字符串表示;

**`在Redis中,C语言的字符串只会作为字符串字面量用在一些无须对字符串值进行修改的地方;`**

### `SDS`的定义

每个`sds.h/sdshdr`结构表示一个`SDS`值:

```
struct sdshdr{
	// 记录buf数组中已使用子节的数量
	// 等于SDS所保存字符串的长度
	int len;

	// 记录buf数组中未使用子节的数量
	int free;

	// 子节数组,用于保存字符串
	char buf[];
}
```

**`SDS`遵循C字符串以空字符结尾的惯例,保存空字符的1子节空间不计算在`SDS`的`len`属性里面,并且为空字符分配额外的1子节空间,以及添加空字符到字符串末尾等操作,都是由`SDS`函数自动完成的,所以这个空字符对于`SDS`的使用者来说是完全透明的;**

>遵循空字符结尾,`SDS`可以直接重用一部分C字符串函数库里面的函数;

### C字符串

C语言使用长度为`N+1`的字符数组来表示长度为`N`的字符串,并且字符数组的最后一个元素总是空字符`'\0'`;


### `Redis`自定义字符串结构优势

+ 常数复杂度获取字符串长度:
  + `SDS`在`len`属性中记录了`SDS`本身的长度,获取长度复杂度仅为`O(1)`
  + 设置和更新`SDS`长度的工作是由`SDS`的`API`在执行时自动完成的,无须进行任何手动修改长度的工作; 
+ 杜绝缓冲区溢出
  + 当`SDS API`需要对`SDS`进行修改时,`API`会先检查`SDS`空间是否满足修改所需的要求,如果不满足的话,`API`会自动将`SDS`的空间扩展至执行修改所需的大小,然后才执行实际的修改操作;
  + 