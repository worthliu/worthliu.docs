# 网络基础知识

## 上网过程

访问一个网址,打开一个网页需要经历什么过程?

![network](/images/network.png)

>1. 在你打开`浏览器`之后，在地址栏输入`https://www.baidu.com`这个地址;
2. `浏览器`会自动先识别出这是位于域名`baidu.com`下的一个页面，需要访问`baidu.com`这个域名对应
的服务器;
3. 接着，`浏览器`会调用相应的的操作系统的`API`去解析这个域名，然后你的`Windows`系统会向电脑连
着的`路由`发送**解析请求**;
4. `路由器`上如果之前有**这个域名的解析结果**，并保留在了**缓存**里，就可以**直接返回解析结果了**;
5. 如果`路由器`没有关于这个域名的`缓存`，那路由就会向之前在`路由器`里设置好的**DNS 服务器**请求解析这个域名;
6. 一般的`DNS`服务器会经过一个**递归解析过程**，把解析到的`baidu.com`的`IP`返回给路由，路由再返回给你的电脑;
7. 最后，你的电脑就可以通过`IP地址`，直接访问`baidu.com`的服务器了，然后向**服务器的443端口**请求`https://www.baidu.com`这个地址的内容;
8. 如果网络通畅的话，`baidu.com`的服务器在收到请求后就会把结果返回给你的电脑，网页就打开了。

**(`443端口`即网页浏览端口，主要是用于HTTPS服务;`80端口`用于网页浏览,主要用于HTTP服务)**

## IP

>IP,准确的说是IP地址，解释过来就是`Internet Protocol Address`，**`Internet协议地址`**；

IP地址又分为公网地址和内网地址两种；

>你通过`ADSL拨号`，`光纤猫`接入，这些方法分配到的`IP`,一般都是**公网IP**，直接接在电脑上，别人通过这个`IP`**可以访问到你的电脑了**。
但是一般你都会在猫后面接个`路由`，然后分配出一些类似`192.168.1.XXX`的地址，你的电脑上往往是通过这些地址接入互联网的，这些都是`内网IP`，隔着路由别人是无法直接访问到你的电脑的，因为这个`内网地址`对外面的人来说根本不可见。

内网地址的范围是有规范的，而公网地址绝对不能使用这些地址：
>1. `10.0.0.0/8` –**`10.0.0.0∼10.255.255.255`**
2. `172.16.0.0/12` –**`172.16.0.0∼172.31.255.255`**
3. `192.168.0.0/16` –**`192.168.0.0∼192.168.255.255`**
4. `100.64.0.0/10` –**`100.64.0.0∼100.127.255.255`**

**首先我们要知道，一个`IP地址`是计算机中的一个`32位的2进制数`，`分成4段`，`每段8位`，所以你看到`IP地址`每段的`最大值是255`，但实际上`255`是用于表示`广播地址不会分配给任何主机的`，而`0`是`用于表示整个网络号的`，也不会分配给主机，所以一般你路由能分配的`IP`最后一段肯定是`1∼254`(在`DHCP3`支持的情况下)。**

![ip](/images/IP.png)

>**一个IP 地址看起来是4段，其实是两个部分，分别是`网络号`和`主机号`，按`网络号`范围的不同，`IP地址`分为`ABCDE`5类**;

>+ `A类地址`的`网络号`由一段`(8位)数字`表示，**网络地址最高位必须是0**，所以`A类地址`有`2^7−2(126)个网段`; 剩下的`3段(24位)`表示**主机号**，每个网段有`2^24−2(16777214)`。
+ 类似的可以知道B 类和C 类地址的计算方法;

大概知道了IP 的格式和分类，**掩码表示法**要怎么理解呢? 

>我们看一下“172.16.0.0/12” 的解释过程
1. 我们说了0 表示网络号，准确的说应该是0 提示网络号，前面的`172.16`就是`网络号`，这段是固定的
值
2. 最后的`12`表示采用的是`12位掩码`。**这个掩码**是什么意思?
3. `12位掩码`表示`IP地址`的`高12位`和`1`进行`与(AND)`操作(也就是不变)，剩下`低20位`的空间和`0`进行`与操作`,清空出来分配IP。
4. 也就是说，从`172.16.0.0`开始，分配`2^20个IP地址`，算一下你就知道刚好到了`172.31.255.255`
5. 我们说了`0`和`255`分别表示`网络号和广播地址`，是不能分配给具体设备的，所以实际可用范围是两
者中间的值。


## 什么是端口?

>**端口为不同的`进程/协议`分配了不同的端口**:
1. `http`是`80端口`;
2. `https`是`443端口`;
3. `ftp`数据传输是`21端口`;
4. `ssh`远程登录是`22端口`;
5. `telnet`是`23端口`;
6. `DNS解析`是`53端口`;
不同的协议使用不同的端口,数据就很清晰了,对于一个端口上的数据就肯定有一个统一的协议来解析了;

**因为很多通信协议默认都是使用这些标准端口，**
你如果擅自改成别的端口，客户端并不知晓，就不知道该向哪里请求了。
例如有些网站给自己的内部管理服务器改成了8080 端口或者别的端口，这样可以避免别人发现后台的地址(其实别人要扫描端口也可以发现)，只有知道端口的人才能访问。
**按照规定0∼1023端口都是预留给特定协议的端口范围，其他的应用和私有的协议不应该使用这个范围内的关口，否则可能和现有的服务协议造成端口冲突。**

## 什么是`DHCP`?

`DHCP` 是一个自动分配IP 的系统。例如你的电脑在不联网的时候是不会有任何IP 的，在接入一个路由器之后，你可以自己手动设置IP，但这很繁琐，而且万一两个人设置了一样的IP，就会导致网络冲突。所以普遍的做法是让路由自动分配IP 给机器。

>`DHCP` 的实现过程大概是这样的:
1. 你的电脑接入路由后，就向路由器下的整个网络(所有主机和设备) 发送一个`DHCP` Discover 请求，查询看有没有`DHCP` 服务器
2. 你的路由收到这个请求之后，就反馈给你的电脑一个`DHCP` Offer，告诉它“老子就是`DHCP` 服务器”
3. 也许网络中还有别的也提供`DHCP` 服务的主机(这个情况一般比较少)，但一般来说你的电脑会选择响应最快的那个Offer，然后发送一个`DHCP` Request 请求给他。
4. 路由收到这个`DHCP` Request 之后，就会开始和主机进行一些列握手协议，然后发送相应的IP 配置给他。